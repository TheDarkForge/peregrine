pated@slhs.org





<script type="text/javascript">
    function CreateHierarchyChartControl(parentId, profileId, type, persistControlId) {
        // TODO: Update profileId with the actual user login
        profileId = "i:0#.f|membership|pated@slhs.org";
        if ((i >= 0) & (claimsmode == “f")) {
            var initParam = profileId + ',' + type + ',' + persistControlId;
            var host = document.getElementById(parentId);
            host.setAttribute('width', '100%');
            host.setAttribute('height', '100%');
            Silverlight.createObject
            (
                '/_layouts/ClientBin/hierarchychart.xap',
                host,
                'ProfileBrowserSilverlightControl',
                {
                    top: '30', width: '100%', height: '100%', version: '2.0', isWindowless: 'true', enableHtmlAccess: 'true'
                },
                {
                    onLoad: OnHierarchyChartLoaded
                },
                initParam,
                null
            );
        }
    }


    function OnHierarchyChartLoaded(sender) {
        var params = sender.GetHost().InitParams.split(',');
        var profileId = params[0];
        var profileType = params[1];
        var persistControlId = params[2];
       sender.GetHost().content.HierarchyChartObject.SetPersistControlId(persistControlId);

        // TODO: update your Profile Service Url to your target site
        sender.GetHost().content.HierarchyChartObject.SetProfileServiceUrl('https://stlukes.sharepoint.com/_vti_bin/UserProfileService.asmx';);
        var lastVisitedProfile = GetLastVisitedProfile(persistControlId);
        if (lastVisitedProfile != null) {
            params = lastVisitedProfile.split(',');
            if (params.length > 1) {
                profileId = params[1];
                profileType = params[0];
            }
        }
        sender.GetHost().content.HierarchyChartObject.SetNewProfile(profileId, profileType);
    }
</script>







https://stlukes.sharepoint.com/_vti_bin/UserProfileService.asmx

https://stlukes.sharepoint.com/sites/ittest/SitePages/Home.aspx

https://stlukes.sharepoint.com/sites/web/about-us/SitePages/Organization.aspx



<script type="text/javascript">
function CreateHierarchyChartControl(parentId, profileId, type, persistControlId) {
 // TODO: Update profileId with the actual user login
 profileId = “i:0#.f|membership|pated@slhs.org”;
var i = profileId.indexOf(“|”);
var claimsmode = profileId.substr(i-1,1)
 if ((i >= 0) & (claimsmode == “f”)) {
var initParam = profileId + ‘,’ + type + ‘,’ + persistControlId;
 var host = document.getElementById(parentId);
 host.setAttribute(‘width’, ‘100%’);
host.setAttribute(‘height’, ‘100%’);
Silverlight.createObject
 (
‘/_layouts/ClientBin/hierarchychart.xap’,
host,
‘ProfileBrowserSilverlightControl’,
 {
top: ’30’, width: ‘100%’, height: ‘100%’, version: ‘2.0’, isWindowless: ‘true’, enableHtmlAccess: ‘true’
},
 {
onLoad: OnHierarchyChartLoaded
 },
 initParam,
 null
 );
 }
 }

function OnHierarchyChartLoaded(sender) {
 var params = sender.GetHost().InitParams.split(‘,’);
var profileId = params[0];
 var profileType = params[1];
 var persistControlId = params[2];
 sender.GetHost().content.HierarchyChartObject.SetPersistControlId(persistControlId);
 // TODO: update your Profile Service Url to your target site
 sender.GetHost().content.HierarchyChartObject.SetProfileServiceUrl(‘https://stlukes.sharepoint.com/sites/ittest/’);
var lastVisitedProfile = GetLastVisitedProfile(persistControlId);
 if (lastVisitedProfile != null) {
 params = lastVisitedProfile.split(‘,’);
if (params.length > 1) {
 profileId = params[1];
 profileType = params[0];
 }
 }
 sender.GetHost().content.HierarchyChartObject.SetNewProfile(profileId, profileType);
 }
</script>